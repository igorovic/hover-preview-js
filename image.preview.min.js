/* [https://github.com/sixem/image.preview.js] */
!function(e){e.fn.imagePreview=function(t){function i(){return!(!a.settings.staticPreview&&void 0!=a.settings.mouse)}function r(t,i){return e.inArray(t,i)>-1}function s(e){return $offsets=e.offset(),{top:$offsets.top-a.windowScrollTop,left:$offsets.left-a.windowScrollLeft,offset:$offsets,margin:e.width()+a.settings.triggerMargin}}function o(e,t){return $perc=t/e*100,$perc=$perc>100?100:$perc,$calc=e/100*$perc-a.store.adjustedHeight/100*$perc,a.current.css("max-height",e-(e-a.store.adjustedHeight)+"px"),$calc<a.settings.windowMargin?a.settings.windowMargin:$calc}function n(t){if(void 0==a.current)return!1;a.windowScrollTop=e(window).scrollTop(),a.windowScrollLeft=e(window).scrollLeft(),i()?void 0==a.store.offset&&(a.store.offset=s(a.lastTrigger)):void 0==a.store.offset?($offsets=a.lastTrigger.offset(),a.store.offset={top:a.settings.mouse.pageY-a.windowScrollTop,left:a.settings.mouse.pageX-a.windowScrollLeft,margin:a.settings.triggerMargin}):a.store.offset.left=a.settings.mouse.pageX-a.windowScrollLeft,a.windowWidthH>a.windowWidth-a.store.offset.left?($pos=Math.floor(a.windowWidth-a.store.offset.left+a.settings.triggerMargin),a.current.css({left:"",right:$pos+"px","max-width":a.windowWidth-$pos-a.settings.windowMargin+"px"})):($pos=Math.floor(a.store.offset.left+a.store.offset.margin),a.current.css({left:$pos+"px",right:"","max-width":a.windowWidth-$pos-a.settings.windowMargin+"px"})),void 0==a.store.currentTop&&($max=a.windowHeight-2*a.settings.windowMargin,a.store.adjustedHeight=a.current.height(),a.store.adjustedHeight<$max&&(a.store.currentTop=o($max,a.store.offset.top),a.current.css("top",a.store.currentTop+"px"))),a.current.css("visibility","visible"),a.visible=!0}function d(t){return!1===t?($previews=e("body").find("#video-preview, #image-preview"),$previews.length>0&&$previews.remove(),a.visible=!1,a.current=a.lastSrc=void 0,a.store={adjustedHeight:0,currentHeight:0,currentWidth:0,currentTop:void 0},!1):($data=a.lastTrigger.data("preview"),!1!==$data&&void 0!==$data?a.lastSrc=a.lastTrigger.data("preview"):($attr=a.lastTrigger.attr("href"),"undefined"!=typeof $attr&&!1!==$attr&&(a.lastSrc=$attr)),void 0!=a.lastSrc&&(a.lastExt=a.lastSrc.split(".").pop().toLowerCase(),r(a.lastExt,a.settings.extensions.images)&&(img=new Image,img.orig=a.lastSrc,e(img).on("load",function(){if(!a.visible)return this.orig==a.lastSrc&&(e("body").prepend('<img id="image-preview" src="'+img.src+'">'),a.current=e("body").find("#image-preview"),a.current.on("load",function(){e(document).imagePreview.getDimensions()}),void 0!=a.settings.css?a.current.css(a.requiredCSS).css(a.settings.css):a.current.css(a.requiredCSS)),!0}),img.src=a.lastSrc),void(r(a.lastExt,a.settings.extensions.videos)&&(e("body").prepend('<video id="video-preview" controls loop muted autoplay><source src=""></video>'),$video=e("body").find("#video-preview").first(),a.current=$video,$video.attr("data-orig",a.lastSrc),$video.find("source").attr("src",a.lastSrc),void 0!=a.settings.css?$video.css(a.requiredCSS).css(a.settings.css):$video.css(a.requiredCSS),$video[0].load(),c($video)))))}function c(e){function t(){return void 0!=a.current&&e.data("orig")==a.lastSrc&&(e.prop("readyState")>=3&&e.width()>0&&e.height()>0?(e.one("seeked").prop("currentTime",0),a.currentWidth=e.width(),a.store.currentHeight=e.height(),n(i()?void 0:1),!0):void setTimeout(t,150))}t()}function g(){a.windowWidth=e(window).width(),a.windowHeight=e(window).height(),a.windowWidthH=e(window).width()/2}var a=this;a.settings=e.extend({hoverDelay:150,staticPreview:!0,windowMargin:4,triggerMargin:24,elements:[],extensions:{images:["jpg","jpeg","gif","png","ico","svg","bmp"],videos:["mp4","webm"]}},a.settings,t),a.store={},a.requiredCSS={"max-height":"calc(100% - "+2*a.settings.windowMargin+"px)",visibility:"hidden",position:"fixed",top:a.settings.windowMargin,left:0,"z-index":4,"pointer-events":"none"},e.fn.imagePreview.getDimensions=function(){function e(){return void 0!=a.current&&(a.current.width()>0&&a.current.height()>0?(a.currentWidth=a.current.width(),a.store.currentHeight=a.current.height(),n(i()?void 0:1),!0):void setTimeout(e,150))}e()},function(){if(1>a.settings.elements.length)return!1;g(),e.each(a.settings.elements,function(t,i){$target=e(document).find(i),$target.length>0&&(e(document).on("mouseenter",i,function(t){a.lastTrigger=e(this),a.timer=setTimeout(function(){if(a.visible)return!0;d()},a.settings.hoverDelay)}),e(document).on("mouseleave",i,function(e){clearTimeout(a.timer),d(!1)}),e(window).resize(function(){void 0!==a.resizeTimer&&clearTimeout(a.resizeTimer),a.resizeTimer=setTimeout(function(){g()},250)}),a.settings.staticPreview||e(document).on("mousemove",i,function(e){a.settings.mouse=e,a.visible&&n(1)}))})}()}}(jQuery);