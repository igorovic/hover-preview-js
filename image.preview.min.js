/* [https://github.com/sixem/image.preview.js] */
!function(t){"use strict";t.fn.imagePreview=function(e){function i(t){var e=t.offset();return{top:e.top-g.windowScrollTop,left:e.left-g.windowScrollLeft,offset:e,margin:t.width()+g.settings.triggerMargin}}function r(t,e){var i=e/t*100,r=t/100*(i=i>100?100:i)-g.store.adjustedHeight/100*i;return g.current.css("max-height",t-(t-g.store.adjustedHeight)+"px"),r<g.settings.windowMargin?g.settings.windowMargin:r}function s(){if(void 0==g.current)return!1;g.windowScrollTop=t(window).scrollTop(),g.windowScrollLeft=t(window).scrollLeft(),g.isStatic()?void 0==g.store.offset&&(g.store.offset=i(g.last.trigger)):void 0==g.store.offset?g.store.offset={top:g.settings.mouse.pageY-g.windowScrollTop,left:g.settings.mouse.pageX-g.windowScrollLeft,margin:g.settings.triggerMargin}:g.store.offset.left=g.settings.mouse.pageX-g.windowScrollLeft;var e;if(g.windowWidthH>g.windowWidth-g.store.offset.left?(e=Math.floor(g.windowWidth-g.store.offset.left+g.settings.triggerMargin),g.current.css({left:"",right:e+"px","max-width":g.windowWidth-e-g.settings.windowMargin+"px"})):(e=Math.floor(g.store.offset.left+g.store.offset.margin),g.current.css({left:e+"px",right:"","max-width":g.windowWidth-e-g.settings.windowMargin+"px"})),void 0==g.store.currentTop){var s=g.windowHeight-2*g.settings.windowMargin;g.store.adjustedHeight=g.current.height(),g.store.adjustedHeight<s&&(g.store.currentTop=r(s,g.store.offset.top),g.current.css("top",g.store.currentTop+"px"))}g.current.css("visibility","visible"),g.visible=!0}function n(e){if(!1===e){var i=t("body").find("#video-preview, #image-preview");return i.length>0&&i.remove(),g.visible=!1,g.current=g.last.src=void 0,g.store={adjustedHeight:0,currentHeight:0,currentWidth:0,currentTop:void 0},!1}var r,s;if(r=g.last.trigger.data("preview"),!1!==r&&void 0!==r?g.last.src=g.last.trigger.data("preview"):void 0!==(s=g.last.trigger.is("img")?g.last.trigger.attr("src"):g.last.trigger.attr("href"))&&!1!==s&&(g.last.src=s),void 0==g.last.src)return!1;if(g.last.ext=g.last.src.split(".").pop().toLowerCase(),g.arrayContains(g.last.ext,g.settings.extensions.images)){null===g.loading&&(t(g).trigger("loadChange",!0),g.loading=!0);var n=new Image;n.orig=g.last.src,t(n).on("load",function(){if(!g.visible){if(this.orig==g.last.src){var e=t("<img>",{id:"image-preview",src:n.src}).appendTo(t("body"));g.current=e,g.current.on("load",function(){g.getDimensions()}),void 0!=g.settings.css?g.current.css(g.css.required).css(g.settings.css):g.current.css(g.css.required),null!==g.loading&&(t(g).trigger("loadChange",!1),g.loading=null),t(g).trigger("loaded",{itemType:0,element:e,source:this.orig,dimensions:{width:this.width,height:this.height}})}return!0}}),n.src=g.last.src}if(g.arrayContains(g.last.ext,g.settings.extensions.videos)){null===g.loading&&(t(g).trigger("loadChange",!0),g.loading=!0);var o=t("<video/>",{id:"video-preview",controls:"",loop:"",muted:"",autoplay:""}).prependTo(t("body")),d=t("<source>",{src:""}).prependTo(o);g.current=o,o.attr("data-orig",g.last.src),d.attr("src",g.last.src),void 0!=g.settings.css?o.css(g.css.required).css(g.settings.css):o.css(g.css.required),o[0].muted=!0,o[0].load(),g.waitForVideo(o)}}function o(){g.windowWidth=t(window).width(),g.windowHeight=t(window).height(),g.windowWidthH=t(window).width()/2}var g={loading:null,store:{},last:{},css:{required:{}}};return g.settings=t.extend({hoverDelay:75,staticPreview:!0,windowMargin:4,triggerMargin:24,elements:[],extensions:{images:["jpg","jpeg","gif","png","ico","svg","bmp"],videos:["mp4","webm"]}},g.settings,e),g.css.required={"max-height":"calc(100% - "+2*g.settings.windowMargin+"px)",visibility:"hidden",position:"fixed",top:g.settings.windowMargin,left:0,"z-index":9999,"pointer-events":"none"},g.refreshSettings=function(){g.css.required["max-height"]="calc(100% - "+2*g.settings.windowMargin+"px)",g.css.required.top=g.settings.windowMargin},g.isStatic=function(){return!(!g.settings.staticPreview&&void 0!=g.settings.mouse)},g.arrayContains=function(e,i){return t.inArray(e,i)>-1},g.waitForVideo=function(e){function i(){return void 0!=g.current&&e.data("orig")==g.last.src&&(e.prop("readyState")>=3&&e.width()>0&&e.height()>0?(e.one("seeked").prop("currentTime",0),g.currentWidth=e.width(),g.store.currentHeight=e.height(),s(g.isStatic()?void 0:1),e[0].play(),t(g).trigger("loadChange",!1),null!==g.loading&&(t(g).trigger("loadChange",!1),g.loading=null),t(g).trigger("loaded",{itemType:1,element:e,source:e.data("orig"),dimensions:{width:e.width(),height:e.height()}}),!0):void setTimeout(i,150))}i()},g.getDimensions=function(){function t(){return void 0!=g.current&&(g.current.width()>0&&g.current.height()>0?(g.currentWidth=g.current.width(),g.store.currentHeight=g.current.height(),s(g.isStatic()?void 0:1),!0):void setTimeout(t,150))}t()},function(){if(1>g.settings.elements.length)return!1;o(),t.each(g.settings.elements,function(e,i){t(document).off("mouseenter",i).on("mouseenter",i,function(e){g.last.trigger=t(this),g.timer=setTimeout(function(){if(g.visible)return!0;n()},g.settings.hoverDelay)}),t(document).off("mouseleave",i).on("mouseleave",i,function(e){null!==g.loading&&(t(g).trigger("loadChange",!1),g.loading=null),clearTimeout(g.timer),n(!1)}),t(window).off("resize").on("resize",function(){void 0!==g.resizeTimer&&clearTimeout(g.resizeTimer),g.resizeTimer=setTimeout(function(){o()},250)}),g.settings.staticPreview||t(document).off("mousemove",i).on("mousemove",i,function(t){g.settings.mouse=t,g.visible&&s(1)})})}(),g}}(jQuery);