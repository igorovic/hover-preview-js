/* [https://github.com/sixem/image.preview.js] */
function arrayContains(i,e){return $.inArray(i,e)>-1}function getElementPositions(i){return $offsets=i.offset(),{top:$offsets.top-$(window).scrollTop(),left:$offsets.left-$(window).scrollLeft(),offset:$offsets}}function previewShow(i){return 0==i?($("body").find("#video-preview, #image-preview").remove(),ipjs.visible=!1,ipjs.current=ipjs.lastSrc=void 0,ipjs.currentHeight=ipjs.currentWidth=0,!1):($data=ipjs.lastTrigger.data("preview"),!1!==$data&&void 0!==$data?ipjs.lastSrc=ipjs.lastTrigger.data("preview"):($attr=ipjs.lastTrigger.attr("href"),"undefined"!=typeof $attr&&!1!==$attr&&(ipjs.lastSrc=$attr)),void 0!=ipjs.lastSrc&&(ipjs.lastExt=ipjs.lastSrc.split(".").pop().toLowerCase(),arrayContains(ipjs.lastExt,ipjs.extensions.images)&&(img=new Image,img.orig=ipjs.lastSrc,$(img).on("load",function(){if(!ipjs.visible)return this.orig==ipjs.lastSrc&&($("body").prepend('<img id="image-preview" onload="getDimensions();" src="'+img.src+'">'),ipjs.current=$("body").find("#image-preview"),ipjs.current.css(ipjs.css)),!0}),img.src=ipjs.lastSrc),void(arrayContains(ipjs.lastExt,ipjs.extensions.videos)&&($("body").prepend('<video id="video-preview" controls loop muted autoplay><source src=""></video>'),$video=$("body").find("#video-preview").first(),ipjs.current=$video,$video.attr("data-orig",ipjs.lastSrc),$video.find("source").attr("src",ipjs.lastSrc),$video.css(ipjs.css),$video[0].load(),waitForVideo($video)))))}function waitForVideo(i){function e(){return void 0!=ipjs.current&&i.data("orig")==ipjs.lastSrc&&(i.prop("readyState")>3&&i.width()>0&&i.height()>0?(i.one("seeked").prop("currentTime",0),ipjs.currentWidth=i.width(),ipjs.currentHeight=i.height(),previewAdjust(),!0):void setTimeout(e,100))}e()}function getDimensions(){function i(){return void 0!=ipjs.current&&(ipjs.current.width()>0&&ipjs.current.height()>0?(ipjs.currentWidth=ipjs.current.width(),ipjs.currentHeight=ipjs.current.height(),previewAdjust(),!0):void setTimeout(i,100))}i()}function previewAdjust(){if(void 0==ipjs.current)return!1;$ww=$(window).width(),$offset=getElementPositions(ipjs.lastTrigger),$ww/2>$ww-$offset.left?($pos=Math.floor($ww-$offset.left+10),ipjs.current.css({left:"",right:$pos+"px","max-width":$ww-$pos-4+"px"})):($pos=Math.floor($offset.left+ipjs.lastTrigger.width()+10),ipjs.current.css({left:$pos+"px",right:"","max-width":$ww-$pos-4+"px"})),ipjs.current.height()<ipjs.currentHeight&&(ipjs.currentHeight=ipjs.current.height()),$x=$offset.top-ipjs.currentHeight,$x>10&&ipjs.current.css("margin-top",$x+"px"),ipjs.current.css("visibility","visible"),ipjs.visible=!0}ipjs={hoverDelay:150,timer:void 0,lastSrc:void 0,lastExt:void 0,lastTrigger:void 0,current:void 0,currentHeight:0,currentWidth:0,visible:!1,extensions:{images:["jpg","jpeg","gif","png","ico","svg","bmp"],videos:["mp4","webm"]},css:{"max-height":"calc(100% - 8px)",visibility:"hidden","-webkit-box-shadow":"0px 0px 3px 0px rgba(0,0,0,0.35)","-moz-box-shadow":"0px 0px 3px 0px rgba(0,0,0,0.35)","box-shadow":"0px 0px 3px 0px rgba(0,0,0,0.35)",position:"fixed",top:4,left:0,"z-index":4}},$(document).ready(function(){$(document).on("mouseenter",".preview",function(i){ipjs.lastTrigger=$(this),ipjs.timer=setTimeout(function(){if(ipjs.visible)return!0;previewShow()},ipjs.hoverDelay)}),$(document).on("mouseleave",".preview",function(i){clearTimeout(ipjs.timer),previewShow(!1)})}),$(window).resize(function(){previewAdjust()});